#!/bin/sh
#
# dot - dotfiles management tool

set -e

DOTFILES="$HOME/.dotfiles"

usage() {
  echo "dot - dotfiles management"
  echo ""
  echo "Usage: dot <command>"
  echo ""
  echo "Commands:"
  echo "  cd       Print dotfiles path (use with: cd \$(dot cd))"
  echo "  edit     Open dotfiles in editor"
  echo "  update   Pull latest changes from git"
  echo "  install  Run bootstrap.sh"
  echo "  help     Show this help message"
}

cmd_cd() {
  echo "$DOTFILES"
}

cmd_edit() {
  ${EDITOR:-vim} "$DOTFILES"
}

cmd_update() {
  echo "Updating dotfiles..."
  git -C "$DOTFILES" pull --rebase --stat
  echo "Done!"
}

cmd_install() {
  echo "Running bootstrap.sh..."
  "$DOTFILES/bootstrap.sh"
}

case "${1:-help}" in
  cd)      cmd_cd ;;
  edit)    cmd_edit ;;
  update)  cmd_update ;;
  install) cmd_install ;;
  help|-h|--help) usage ;;
  *)
    echo "Unknown command: $1"
    echo ""
    usage
    exit 1
    ;;
esac
